<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<title>Zoomable TimeSeries</title>

	<!-- <link href="../../assets/styles.css" rel="stylesheet" /> -->

	<style>
		#chart {
			max-width: 90%;
			margin: 35px auto;
		}
	</style>

	<!-- <script>
      window.Promise ||
        document.write(
          '<script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js"><\/script>'
        )
      window.Promise ||
        document.write(
          '<script src="https://cdn.jsdelivr.net/npm/eligrey-classlist-js-polyfill@1.2.20171210/classList.min.js"><\/script>'
        )
      window.Promise ||
        document.write(
          '<script src="https://cdn.jsdelivr.net/npm/findindex_polyfill_mdn"><\/script>'
        )
    </script> -->


	<script src="lib/apexcharts.min.js"></script>


	<script>
		// Replace Math.random() with a pseudo-random number generator to get reproducible results in e2e tests
		// Based on https://gist.github.com/blixt/f17b47c62508be59987b
		var _seed = 42;
		Math.random = function () {
			_seed = _seed * 16807 % 2147483647;
			return (_seed - 1) / 2147483646;
		};
	</script>

	<script>
		function parseLine(line) {
			let fields = line.split(',');
			let time = new Date(fields[0]).getTime();
			let value = parseInt(fields[1]);
			return { x: time, y: value };
		}
		async function getData() {
			var data = await fetch('data.csv')
				.then(response => response.text())
				.then(text => text.trim().split('\n'));
				console.log(data.map(parseLine));
			return data.map(parseLine);
		}
	</script>
</head>

<body>
	<div id="chart"></div>

	<script>
		function doGraph(data) {
			var options = {
				series: [{
					name: 'Internet Connection',
					data: data,
				}],
				chart: {
					type: 'line',
					height: 350,
				},
				title: {
					text: 'Internet Connection',
					align: 'left'
				},
				fill: {
					type: 'gradient',
					gradient: {
						type: 'vertical',
						inverseColors: false,
						gradientToColors: ["#FF3377"],
					},
				},
				yaxis: {
					labels: {
						formatter: function (val) {
							return val.toFixed(0);
						},
					},
					title: {
						text: 'Connectivity'
					},
				},
				xaxis: {
					type: 'datetime',
					labels: {
						datetimeUTC: false,
					},
					tooltip: {
						formatter: function (val) {
							return new Date(val).toLocaleString('es-AR');
						}
					}
				},
				tooltip: {
					shared: false,
					y: {
						formatter: function (val) {
							return val.toFixed(0);
						}
					}
				}
			};

			var chart = new ApexCharts(document.querySelector("#chart"), options);
			chart.render();
		}

		getData().then(doGraph);
	</script>


</body>

</html>